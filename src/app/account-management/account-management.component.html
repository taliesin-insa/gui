<div class="col-lg-8 offset-lg-2 card">
  <h2 class="font-weight-bold ml-1" style="font-size: 2.5em">Gestion des comptes</h2>
  <hr>

  <!-- Accounts list -->
  <table class="table table-striped table-bordered table-hover">
    <thead>
    <tr>
      <th scope="col" class="text-center">Identifiant</th>
      <th scope="col" class="text-center">Adresse mail</th>
      <th scope="col" class="text-center">Administrateur</th>
    </tr>
    </thead>
    <tbody>

    <!-- Generate a table row for all the accounts -->
    <ng-container *ngFor="let account of accounts">
      <tr (click)="selectedAccount = account;">
        <td>{{account.name}}</td>
        <td>{{account.email}}</td>
        <td class="text-center">{{(account.role) ? 'Oui' : 'Non'}}</td>
      </tr>
    </ng-container>

    </tbody>
  </table>
  <!-- /Accounts list -->

  <!-- Selected account modification -->
  <div *ngIf="selectedAccount">
    <hr>
    <h4 class="font-weight-bold">Détails du compte : </h4>

    <form [formGroup]="changeAccountForm">

      <div class="row">
        <div class="col text-center">
          <label for="updateName">Identifiant : </label>
          <input [ngModel]="selectedAccount.name" type="text" formControlName="name" id="updateName">
        </div>
        <div class="col text-center">
          <label for="updateEmail">Adresse mail : </label>
          <input [ngModel]="selectedAccount.email" type="text" formControlName="email" id="updateEmail">
        </div>
        <div class="col text-center">
          <label for="updateRole">Droits d'administration : </label>
          <input [ngModel]="selectedAccount.role" type="checkbox" formControlName="role" id="updateRole">
        </div>
      </div>

      <div class="col-xs-6 text-center">
        <button type="submit" class="btn btn-info btn-text font-weight-bold"
                (click)="updateSelectedAccount(changeAccountForm.value)">
          Enregistrer
        </button>
        <button class="btn btn-danger btn-text font-weight-bold" (click)="modalService.open(popUpDelete)">
          Supprimer
        </button>
      </div>

    </form>

    <!-- Template for the confirmation modal attached with the account suppression button -->
    <ng-template #popUpDelete let-modal>
      <div class="modal-header alert-danger">
        <h4 class="modal-title" id="modal-basic-title">Attention</h4>
      </div>
      <div class="modal-body">
        Vous allez supprimer le compte sélectionné, êtes-vous certain de votre décision ?
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary" (click)="modal.close() ; deleteAccount(selectedAccount);">
          Continuer
        </button>
        <button type="button" class="btn btn-light" (click)="modal.close()">Annuler</button>
      </div>
    </ng-template>
    <!-- /Template suppression modal -->

  </div>
  <!-- /Selected account modification -->
  <hr>

  <!-- New account form -->
  <div>
    <h4 class="font-weight-bold">Ajouter un compte : </h4>

    <form [formGroup]="newAccountForm" (ngSubmit)="createNewAccount(newAccountForm.value)">

      <div class=" row position-relative mx-auto">
        <div class="col-3">
          <label for="newName">Identifiant : </label>
          <input type="text" formControlName="name" id="newName">
        </div>
        <div class="col-3">
          <label for="newEmail">Adresse mail : </label>
          <input type="text" formControlName="email" id="newEmail">
        </div>
        <div class="col-3">
          <label for="newRole">Droits d'administration : </label>
          <input type="checkbox" formControlName="role" id="newRole">
        </div>
      </div>

      <div class="col-xs-6 text-center">
        <button type="submit" class="btn btn-success btn-text font-weight-bold">
          Nouveau compte
        </button>
      </div>

    </form>
  </div>
  <!-- /New account form -->

</div>
